{"version":3,"file":"yox-touch.js","sources":["../src/index.js"],"sourcesContent":["\nlet Yox, Hammer\n\n/**\n * 版本\n *\n * @type {string}\n */\nexport const version = process.env.NODE_VERSION\n\nconst NULL = null\n\nfunction isEmptyHandlers(handlers) {\n  let isEmpty = true\n  if (handlers) {\n    for (let key in handlers) {\n      if (!Yox.array.falsy(handlers[key])) {\n        isEmpty = false\n        break\n      }\n    }\n  }\n  return isEmpty\n}\n\n/**\n * 支持的事件，即 on-double-tap 支持的写法\n *\n * @type {object}\n */\nconst events = {\n  tap: NULL,\n  doubleTap: NULL,\n\n  press: NULL,\n  pressUp: NULL,\n\n  pinchStart: NULL,\n  pinchMove: NULL,\n  pinchEnd: NULL,\n  pinchCancel: NULL,\n  pinchIn: NULL,\n  pinchOut: NULL,\n\n  rotateStart: NULL,\n  rotateMove: NULL,\n  rotateEnd: NULL,\n  rotateCancel: NULL,\n\n  swipeLeft: NULL,\n  swipeRight: NULL,\n\n  panStart: NULL,\n  panMove: NULL,\n  panEnd: NULL,\n  panCancel: NULL,\n  panLeft: NULL,\n  panRight: NULL,\n}\n\nexport function addGesture(name, gesture) {\n  const lowerName = name.toLowerCase()\n  Yox.dom.addSpecialEvent(\n    name,\n    {\n      on(node, listener) {\n        if (gesture) {\n          let manager = node.$manager\n          if (!manager) {\n            manager = node.$manager = new Hammer.Manager(node)\n            manager.add(gesture)\n          }\n          manager.on(lowerName, listener)\n        }\n        else {\n          const hammer = node.$hammer || (node.$hammer = new Hammer(node))\n          hammer.on(lowerName, listener)\n        }\n      },\n      off(node, listener) {\n        if (gesture) {\n          const manager = node.$manager\n          manager.off(lowerName, listener)\n          if (isEmptyHandlers(manager.handlers)) {\n            manager.destroy()\n            node.$manager = NULL\n          }\n        }\n        else {\n          const hammer = node.$hammer\n          hammer.off(lowerName, listener)\n          if (isEmptyHandlers(hammer.handlers)) {\n            hammer.destroy()\n            node.$hammer = NULL\n          }\n        }\n      }\n    }\n  )\n}\n\n\nexport function setHammer(library) {\n  Hammer = library\n}\n\nexport function install(library) {\n\n  Yox = library\n\n  Yox.object.each(\n    events,\n    function (_, name) {\n      addGesture(name)\n    }\n  )\n\n  // 默认扩展一个长按手势\n  addGesture(\n    'longPress',\n    new Hammer.Press({\n      event: 'longpress',\n      time: 500\n    })\n  )\n\n}\n"],"names":["let","const"],"mappings":"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"}