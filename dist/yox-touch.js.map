{"version":3,"file":"yox-touch.js","sources":["../src/index.js"],"sourcesContent":["\nlet Hammer\n\n/**\n * 版本\n *\n * @type {string}\n */\nexport const version = process.env.NODE_VERSION\n\nconst NULL = null\n\nfunction isEmptyHandlers(handlers) {\n  let isEmpty = true\n  if (handlers) {\n    for (let key in handlers) {\n      if (!Yox.array.falsy(handlers[key])) {\n        isEmpty = false\n        break\n      }\n    }\n  }\n  return isEmpty\n}\n\n/**\n * 支持的事件，即 on-double-tap 支持的写法\n *\n * @type {object}\n */\nconst events = {\n  tap: NULL,\n  doubleTap: NULL,\n\n  press: NULL,\n  pressUp: NULL,\n\n  pinchStart: NULL,\n  pinchMove: NULL,\n  pinchEnd: NULL,\n  pinchCancel: NULL,\n  pinchIn: NULL,\n  pinchOut: NULL,\n\n  rotateStart: NULL,\n  rotateMove: NULL,\n  rotateEnd: NULL,\n  rotateCancel: NULL,\n\n  swipeLeft: NULL,\n  swipeRight: NULL,\n\n  panStart: NULL,\n  panMove: NULL,\n  panEnd: NULL,\n  panCancel: NULL,\n  panLeft: NULL,\n  panRight: NULL,\n}\n\nexport function setHammer(library) {\n  Hammer = library\n  // 默认扩展一个长按手势\n  addGesture(\n    'longPress',\n    new Hammer.Press({\n      event: 'longpress',\n      time: 1000\n    })\n  )\n}\n\nexport function addGesture(name, gesture) {\n  const lowerName = name.toLowerCase()\n  events[name] = {\n    on(node, listener) {\n      let manager = node.$manager\n\n      if (!manager) {\n        manager = node.$manager = new Hammer.Manager(node)\n        manager.add(gesture)\n      }\n\n      manager.on(lowerName, listener)\n    },\n    off(node, listener) {\n      const manager = node.$manager\n      manager.off(lowerName, listener)\n      if (isEmptyHandlers(manager.handlers)) {\n        manager.destroy()\n        node.$manager = NULL\n      }\n    }\n  }\n}\n\nexport function install(Yox) {\n\n  Yox.object.each(\n    events,\n    function (customEvent, name) {\n      const lowerName = name.toLowerCase()\n      Yox.dom.addSpecialEvent(\n        name,\n        {\n          on(node, listener) {\n            if (customEvent && customEvent.on) {\n              customEvent.on(node, listener)\n            }\n            else {\n              const hammer = node.$hammer || (node.$hammer = new Hammer(node))\n              hammer.on(lowerName, listener)\n            }\n          },\n          off(node, listener) {\n            if (customEvent && customEvent.off) {\n              customEvent.off(node, listener)\n            }\n            else {\n              const hammer = node.$hammer\n              hammer.off(lowerName, listener)\n              if (isEmptyHandlers(hammer.handlers)) {\n                hammer.destroy()\n                node.$hammer = NULL\n              }\n            }\n          }\n        }\n      )\n    }\n  )\n\n}\n"],"names":["let","const"],"mappings":"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"}