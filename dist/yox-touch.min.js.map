{"version":3,"file":"yox-touch.min.js","sources":["../src/index.js"],"sourcesContent":["\nlet Hammer\n\n/**\n * 版本\n *\n * @type {string}\n */\nexport const version = process.env.NODE_VERSION\n\nconst NULL = null\n\nfunction isEmptyHandlers(handlers) {\n  let isEmpty = true\n  if (handlers) {\n    for (let key in handlers) {\n      if (!Yox.array.falsy(handlers[key])) {\n        isEmpty = false\n        break\n      }\n    }\n  }\n  return isEmpty\n}\n\n/**\n * 支持的事件，即 on-double-tap 支持的写法\n *\n * @type {object}\n */\nconst events = {\n  tap: NULL,\n  doubleTap: NULL,\n\n  press: NULL,\n  pressUp: NULL,\n\n  pinchStart: NULL,\n  pinchMove: NULL,\n  pinchEnd: NULL,\n  pinchCancel: NULL,\n  pinchIn: NULL,\n  pinchOut: NULL,\n\n  rotateStart: NULL,\n  rotateMove: NULL,\n  rotateEnd: NULL,\n  rotateCancel: NULL,\n\n  swipeLeft: NULL,\n  swipeRight: NULL,\n\n  panStart: NULL,\n  panMove: NULL,\n  panEnd: NULL,\n  panCancel: NULL,\n  panLeft: NULL,\n  panRight: NULL,\n}\n\nexport function setHammer(library) {\n  Hammer = library\n  // 默认扩展一个长按手势\n  addGesture(\n    'longPress',\n    new Hammer.Press({\n      event: 'longpress',\n      time: 1000\n    })\n  )\n}\n\nexport function addGesture(name, gesture) {\n  const lowerName = Yox.string.lower(name)\n  events[name] = {\n    on(node, listener) {\n      let manager = node.$manager\n\n      if (!manager) {\n        manager = node.$manager = new Hammer.Manager(node)\n        manager.add(gesture)\n      }\n\n      manager.on(lowerName, listener)\n    },\n    off(node, listener) {\n      const manager = node.$manager\n      manager.off(lowerName, listener)\n      if (isEmptyHandlers(manager.handlers)) {\n        manager.destroy()\n        node.$manager = NULL\n      }\n    }\n  }\n}\n\nexport function install(Yox) {\n\n  Yox.object.each(\n    events,\n    function (customEvent, name) {\n      const lowerName = Yox.string.lower(name)\n      Yox.dom.addSpecialEvent(\n        name,\n        {\n          on(node, listener) {\n            if (customEvent && customEvent.on) {\n              customEvent.on(node, listener)\n            }\n            else {\n              const hammer = node.$hammer || (node.$hammer = new Hammer(node))\n              hammer.on(lowerName, listener)\n            }\n          },\n          off(node, listener) {\n            if (customEvent && customEvent.off) {\n              customEvent.off(node, listener)\n            }\n            else {\n              const hammer = node.$hammer\n              hammer.off(lowerName, listener)\n              if (isEmptyHandlers(hammer.handlers)) {\n                hammer.destroy()\n                node.$hammer = NULL\n              }\n            }\n          }\n        }\n      )\n    }\n  )\n\n}\n"],"names":["let","Hammer","NULL","isEmptyHandlers","handlers","isEmpty","key","Yox","array","falsy","const","events","tap","doubleTap","press","pressUp","pinchStart","pinchMove","pinchEnd","pinchCancel","pinchIn","pinchOut","rotateStart","rotateMove","rotateEnd","rotateCancel","swipeLeft","swipeRight","panStart","panMove","panEnd","panCancel","panLeft","panRight","addGesture","name","gesture","lowerName","string","lower","on","node","listener","manager","$manager","Manager","add","off","destroy","object","each","customEvent","dom","addSpecialEvent","$hammer","hammer","library","Press","event","time"],"mappings":"qMACAA,IAAIC,EASEC,EAAO,KAEb,SAASC,EAAgBC,GACvBJ,IAAIK,GAAU,EACd,GAAID,EACF,IAAKJ,IAAIM,KAAOF,EACd,IAAKG,IAAIC,MAAMC,MAAML,EAASE,IAAO,CACnCD,GAAU,EACV,MAIN,OAAOA,EAQTK,IAAMC,EAAS,CACbC,IAAKV,EACLW,UAAWX,EAEXY,MAAOZ,EACPa,QAASb,EAETc,WAAYd,EACZe,UAAWf,EACXgB,SAAUhB,EACViB,YAAajB,EACbkB,QAASlB,EACTmB,SAAUnB,EAEVoB,YAAapB,EACbqB,WAAYrB,EACZsB,UAAWtB,EACXuB,aAAcvB,EAEdwB,UAAWxB,EACXyB,WAAYzB,EAEZ0B,SAAU1B,EACV2B,QAAS3B,EACT4B,OAAQ5B,EACR6B,UAAW7B,EACX8B,QAAS9B,EACT+B,SAAU/B,GAeL,SAASgC,EAAWC,EAAMC,GAC/B1B,IAAM2B,EAAY9B,IAAI+B,OAAOC,MAAMJ,GACnCxB,EAAOwB,GAAQ,CACbK,YAAGC,EAAMC,GACP1C,IAAI2C,EAAUF,EAAKG,SAEdD,IACHA,EAAUF,EAAKG,SAAW,IAAI3C,EAAO4C,QAAQJ,IACrCK,IAAIV,GAGdO,EAAQH,GAAGH,EAAWK,IAExBK,aAAIN,EAAMC,GACRhC,IAAMiC,EAAUF,EAAKG,SACrBD,EAAQI,IAAIV,EAAWK,GACnBvC,EAAgBwC,EAAQvC,YAC1BuC,EAAQK,UACRP,EAAKG,SAAW1C,8BAMjB,SAAiBK,GAEtBA,EAAI0C,OAAOC,KACTvC,EACA,SAAUwC,EAAahB,GACrBzB,IAAM2B,EAAY9B,EAAI+B,OAAOC,MAAMJ,GACnC5B,EAAI6C,IAAIC,gBACNlB,EACA,CACEK,YAAGC,EAAMC,GACHS,GAAeA,EAAYX,GAC7BW,EAAYX,GAAGC,EAAMC,IAGND,EAAKa,UAAYb,EAAKa,QAAU,IAAIrD,EAAOwC,KACnDD,GAAGH,EAAWK,IAGzBK,aAAIN,EAAMC,GACR,GAAIS,GAAeA,EAAYJ,IAC7BI,EAAYJ,IAAIN,EAAMC,OAEnB,CACHhC,IAAM6C,EAASd,EAAKa,QACpBC,EAAOR,IAAIV,EAAWK,GAClBvC,EAAgBoD,EAAOnD,YACzBmD,EAAOP,UACPP,EAAKa,QAAUpD,sBA/DxB,SAAmBsD,GAGxBtB,EACE,YACA,IAJFjC,EAASuD,GAIIC,MAAM,CACfC,MAAO,YACPC,KAAM,kBA3DW"}