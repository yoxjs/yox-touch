{"version":3,"file":"yox-touch.min.js","sources":["../src/index.js"],"sourcesContent":["\nconst Hammer = typeof require === 'function'\n    ? require('hammerjs')\n    : window.Hammer\n\nif (!Hammer) {\n  throw new Error('[yox-touch] cannot locate Hammer.js.')\n}\n\n/**\n * 版本\n *\n * @type {string}\n */\nexport const version = process.env.NODE_VERSION\n\nconst NULL = null\n\nfunction isEmptyHandlers(handlers) {\n  let isEmpty = true\n  if (handlers) {\n    for (let key in handlers) {\n      if (!Yox.array.falsy(handlers[key])) {\n        isEmpty = false\n        break\n      }\n    }\n  }\n  return isEmpty\n}\n\n/**\n * 支持的事件，即 on-double-tap 支持的写法\n *\n * @type {object}\n */\nconst events = {\n  tap: NULL,\n  doubleTap: NULL,\n\n  press: NULL,\n  pressUp: NULL,\n\n  pinchStart: NULL,\n  pinchMove: NULL,\n  pinchEnd: NULL,\n  pinchCancel: NULL,\n  pinchIn: NULL,\n  pinchOut: NULL,\n\n  rotateStart: NULL,\n  rotateMove: NULL,\n  rotateEnd: NULL,\n  rotateCancel: NULL,\n\n  swipeLeft: NULL,\n  swipeRight: NULL,\n\n  panStart: NULL,\n  panMove: NULL,\n  panEnd: NULL,\n  panCancel: NULL,\n  panLeft: NULL,\n  panRight: NULL,\n}\n\nexport function addGesture(name, gesture) {\n  const lowerName = Yox.string.lower(name)\n  events[name] = {\n    on(node, listener) {\n      let manager = node.$manager\n\n      if (!manager) {\n        manager = node.$manager = new Hammer.Manager(node)\n        manager.add(gesture)\n      }\n\n      manager.on(lowerName, listener)\n    },\n    off(node, listener) {\n      const manager = node.$manager\n      manager.off(lowerName, listener)\n      if (isEmptyHandlers(manager.handlers)) {\n        manager.destroy()\n        node.$manager = NULL\n      }\n    }\n  }\n}\n\n// 默认扩展一个长按手势\naddGesture(\n  'longPress',\n  new Hammer.Press({\n    event: 'longpress',\n    time: 1000\n  })\n)\n\nexport function install(Yox) {\n\n  Yox.object.each(\n    events,\n    function (customEvent, name) {\n      const lowerName = Yox.string.lower(name)\n      Yox.dom.addSpecialEvent(\n        name,\n        {\n          on(node, listener) {\n            if (customEvent && customEvent.on) {\n              customEvent.on(node, listener)\n            }\n            else {\n              const hammer = node.$hammer || (node.$hammer = new Hammer(node))\n              hammer.on(lowerName, listener)\n            }\n          },\n          off(node, listener) {\n            if (customEvent && customEvent.off) {\n              customEvent.off(node, listener)\n            }\n            else {\n              const hammer = node.$hammer\n              hammer.off(lowerName, listener)\n              if (isEmptyHandlers(hammer.handlers)) {\n                hammer.destroy()\n                node.$hammer = NULL\n              }\n            }\n          }\n        }\n      )\n    }\n  )\n\n}\n"],"names":["const","Hammer","require","window","Error","NULL","isEmptyHandlers","handlers","let","isEmpty","key","Yox","array","falsy","events","tap","doubleTap","press","pressUp","pinchStart","pinchMove","pinchEnd","pinchCancel","pinchIn","pinchOut","rotateStart","rotateMove","rotateEnd","rotateCancel","swipeLeft","swipeRight","panStart","panMove","panEnd","panCancel","panLeft","panRight","addGesture","name","gesture","lowerName","string","lower","on","node","listener","manager","$manager","Manager","add","off","destroy","Press","event","time","object","each","customEvent","dom","addSpecialEvent","$hammer","hammer"],"mappings":"qMACAA,IAAMC,EAA4B,mBAAZC,QAChBA,QAAQ,YACRC,OAAOF,OAEb,IAAKA,EACH,MAAM,IAAIG,MAAM,4CAUZC,EAAO,KAEb,SAASC,EAAgBC,GACvBC,IAAIC,GAAU,EACd,GAAIF,EACF,IAAKC,IAAIE,KAAOH,EACd,IAAKI,IAAIC,MAAMC,MAAMN,EAASG,IAAO,CACnCD,GAAU,EACV,MAIN,OAAOA,EAQTT,IAAMc,EAAS,CACbC,IAAKV,EACLW,UAAWX,EAEXY,MAAOZ,EACPa,QAASb,EAETc,WAAYd,EACZe,UAAWf,EACXgB,SAAUhB,EACViB,YAAajB,EACbkB,QAASlB,EACTmB,SAAUnB,EAEVoB,YAAapB,EACbqB,WAAYrB,EACZsB,UAAWtB,EACXuB,aAAcvB,EAEdwB,UAAWxB,EACXyB,WAAYzB,EAEZ0B,SAAU1B,EACV2B,QAAS3B,EACT4B,OAAQ5B,EACR6B,UAAW7B,EACX8B,QAAS9B,EACT+B,SAAU/B,GAGL,SAASgC,EAAWC,EAAMC,GAC/BvC,IAAMwC,EAAY7B,IAAI8B,OAAOC,MAAMJ,GACnCxB,EAAOwB,GAAQ,CACbK,YAAGC,EAAMC,GACPrC,IAAIsC,EAAUF,EAAKG,SAEdD,IACHA,EAAUF,EAAKG,SAAW,IAAI9C,EAAO+C,QAAQJ,IACrCK,IAAIV,GAGdO,EAAQH,GAAGH,EAAWK,IAExBK,aAAIN,EAAMC,GACR7C,IAAM8C,EAAUF,EAAKG,SACrBD,EAAQI,IAAIV,EAAWK,GACnBvC,EAAgBwC,EAAQvC,YAC1BuC,EAAQK,UACRP,EAAKG,SAAW1C,KAOxBgC,EACE,YACA,IAAIpC,EAAOmD,MAAM,CACfC,MAAO,YACPC,KAAM,gCAIH,SAAiB3C,GAEtBA,EAAI4C,OAAOC,KACT1C,EACA,SAAU2C,EAAanB,GACrBtC,IAAMwC,EAAY7B,EAAI8B,OAAOC,MAAMJ,GACnC3B,EAAI+C,IAAIC,gBACNrB,EACA,CACEK,YAAGC,EAAMC,GACHY,GAAeA,EAAYd,GAC7Bc,EAAYd,GAAGC,EAAMC,IAGND,EAAKgB,UAAYhB,EAAKgB,QAAU,IAAI3D,EAAO2C,KACnDD,GAAGH,EAAWK,IAGzBK,aAAIN,EAAMC,GACR,GAAIY,GAAeA,EAAYP,IAC7BO,EAAYP,IAAIN,EAAMC,OAEnB,CACH7C,IAAM6D,EAASjB,EAAKgB,QACpBC,EAAOX,IAAIV,EAAWK,GAClBvC,EAAgBuD,EAAOtD,YACzBsD,EAAOV,UACPP,EAAKgB,QAAUvD,oBAhHR"}