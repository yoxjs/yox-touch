{"version":3,"file":"yox-touch.min.js","sources":["../src/index.js"],"sourcesContent":["\nlet Yox, Hammer\n\n/**\n * 版本\n *\n * @type {string}\n */\nexport const version = process.env.NODE_VERSION\n\nconst NULL = null\n\nfunction isEmptyHandlers(handlers) {\n  let isEmpty = true\n  if (handlers) {\n    for (let key in handlers) {\n      if (!Yox.array.falsy(handlers[key])) {\n        isEmpty = false\n        break\n      }\n    }\n  }\n  return isEmpty\n}\n\n/**\n * 支持的事件，即 on-double-tap 支持的写法\n *\n * @type {object}\n */\nconst events = {\n  tap: NULL,\n  doubleTap: NULL,\n\n  press: NULL,\n  pressUp: NULL,\n\n  pinchStart: NULL,\n  pinchMove: NULL,\n  pinchEnd: NULL,\n  pinchCancel: NULL,\n  pinchIn: NULL,\n  pinchOut: NULL,\n\n  rotateStart: NULL,\n  rotateMove: NULL,\n  rotateEnd: NULL,\n  rotateCancel: NULL,\n\n  swipeLeft: NULL,\n  swipeRight: NULL,\n\n  panStart: NULL,\n  panMove: NULL,\n  panEnd: NULL,\n  panCancel: NULL,\n  panLeft: NULL,\n  panRight: NULL,\n}\n\nexport function addGesture(name, gesture) {\n  const lowerName = name.toLowerCase()\n  Yox.dom.addSpecialEvent(\n    name,\n    {\n      on(node, listener) {\n        if (gesture) {\n          let manager = node.$manager\n          if (!manager) {\n            manager = node.$manager = new Hammer.Manager(node)\n            manager.add(gesture())\n          }\n          manager.on(lowerName, listener)\n        }\n        else {\n          const hammer = node.$hammer || (node.$hammer = new Hammer(node))\n          hammer.on(lowerName, listener)\n        }\n      },\n      off(node, listener) {\n        if (gesture) {\n          const manager = node.$manager\n          manager.off(lowerName, listener)\n          if (isEmptyHandlers(manager.handlers)) {\n            manager.destroy()\n            node.$manager = NULL\n          }\n        }\n        else {\n          const hammer = node.$hammer\n          hammer.off(lowerName, listener)\n          if (isEmptyHandlers(hammer.handlers)) {\n            hammer.destroy()\n            node.$hammer = NULL\n          }\n        }\n      }\n    }\n  )\n}\n\n\nexport function setHammer(library) {\n  Hammer = library\n}\n\nexport function install(library) {\n\n  Yox = library\n\n  Yox.object.each(\n    events,\n    function (_, name) {\n      addGesture(name)\n    }\n  )\n\n  // 默认扩展一个长按手势\n  addGesture(\n    'longPress',\n    function () {\n      return new Hammer.Press({\n        event: 'longpress',\n        time: 500\n      })\n    }\n  )\n\n}\n"],"names":["let","Yox","Hammer","NULL","isEmptyHandlers","handlers","isEmpty","key","array","falsy","const","events","tap","doubleTap","press","pressUp","pinchStart","pinchMove","pinchEnd","pinchCancel","pinchIn","pinchOut","rotateStart","rotateMove","rotateEnd","rotateCancel","swipeLeft","swipeRight","panStart","panMove","panEnd","panCancel","panLeft","panRight","addGesture","name","gesture","lowerName","toLowerCase","dom","addSpecialEvent","on","node","listener","manager","$manager","Manager","add","$hammer","off","destroy","hammer","library","object","each","_","Press","event","time"],"mappings":"qMACAA,IAAIC,EAAKC,EASHC,EAAO,KAEb,SAASC,EAAgBC,GACvBL,IAAIM,GAAU,EACd,GAAID,EACF,IAAKL,IAAIO,KAAOF,EACd,IAAKJ,EAAIO,MAAMC,MAAMJ,EAASE,IAAO,CACnCD,GAAU,EACV,MAIN,OAAOA,EAQTI,IAAMC,EAAS,CACbC,IAAKT,EACLU,UAAWV,EAEXW,MAAOX,EACPY,QAASZ,EAETa,WAAYb,EACZc,UAAWd,EACXe,SAAUf,EACVgB,YAAahB,EACbiB,QAASjB,EACTkB,SAAUlB,EAEVmB,YAAanB,EACboB,WAAYpB,EACZqB,UAAWrB,EACXsB,aAActB,EAEduB,UAAWvB,EACXwB,WAAYxB,EAEZyB,SAAUzB,EACV0B,QAAS1B,EACT2B,OAAQ3B,EACR4B,UAAW5B,EACX6B,QAAS7B,EACT8B,SAAU9B,GAGL,SAAS+B,EAAWC,EAAMC,GAC/B1B,IAAM2B,EAAYF,EAAKG,cACvBrC,EAAIsC,IAAIC,gBACNL,EACA,CACEM,YAAGC,EAAMC,GACP,GAAIP,EAAS,CACXpC,IAAI4C,EAAUF,EAAKG,SACdD,IACHA,EAAUF,EAAKG,SAAW,IAAI3C,EAAO4C,QAAQJ,IACrCK,IAAIX,KAEdQ,EAAQH,GAAGJ,EAAWM,OAEnB,EACYD,EAAKM,UAAYN,EAAKM,QAAU,IAAI9C,EAAOwC,KACnDD,GAAGJ,EAAWM,KAGzBM,aAAIP,EAAMC,GACR,GAAIP,EAAS,CACX1B,IAAMkC,EAAUF,EAAKG,SACrBD,EAAQK,IAAIZ,EAAWM,GACnBvC,EAAgBwC,EAAQvC,YAC1BuC,EAAQM,UACRR,EAAKG,SAAW1C,OAGf,CACHO,IAAMyC,EAAST,EAAKM,QACpBG,EAAOF,IAAIZ,EAAWM,GAClBvC,EAAgB+C,EAAO9C,YACzB8C,EAAOD,UACPR,EAAKM,QAAU7C,gCAapB,SAAiBiD,IAEtBnD,EAAMmD,GAEFC,OAAOC,KACT3C,EACA,SAAU4C,EAAGpB,GACXD,EAAWC,KAKfD,EACE,YACA,WACE,OAAO,IAAIhC,EAAOsD,MAAM,CACtBC,MAAO,YACPC,KAAM,qBArBP,SAAmBN,GACxBlD,EAASkD,aA/FY"}